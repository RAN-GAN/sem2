<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="OS Lab Programs and Solutions" />
    <meta name="theme-color" content="#121212" />
    <title>JavaEndLab</title>
    <!-- Google tag (gtag.js) -->
    <script
      async=""
      src="https://www.googletagmanager.com/gtag/js?id=G-KJEPF1W07E"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-KJEPF1W07E");
    </script>
    <!-- <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css"
    /> -->

    <style>
      /* Theme Variables */
      :root {
        /* Light Theme */
        --light-bg-primary: #ffffff;
        --light-bg-secondary: #f8f9fa;
        --light-bg-code: #f5f5f5;
        --light-text-primary: #000000;
        --light-text-secondary: #333333;
        --light-border-color: #ddd;

        /* Dark Theme */
        --dark-bg-primary: #121212;
        --dark-bg-secondary: #1e1e1e;
        --dark-bg-code: #2c2c2c;
        --dark-text-primary: #e0e0e0;
        --dark-text-secondary: #cccccc;
        --dark-border-color: #404040;

        /* Default Theme (Light) */
        --bg-primary: var(--dark-bg-primary);
        --bg-secondary: var(--dark-bg-secondary);
        --bg-code: var(--dark-bg-code);
        --text-primary: var(--dark-text-primary);
        --text-secondary: var(--dark-text-secondary);
        --border-color: var(--dark-border-color);
      }

      /* Dark Theme Override */
      [data-theme="dark"] {
        --bg-primary: var(--light-bg-primary);
        --bg-secondary: var(--light-bg-secondary);
        --bg-code: var(--light-bg-code);
        --text-primary: var(--light-text-primary);
        --text-secondary: var(--light-text-secondary);
        --border-color: var(--light-border-color);
      }

      /* Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      /* Accessibility */
      @media (prefers-reduced-motion: reduce) {
        * {
          transition: none !important;
        }
      }

      /* High Contrast Support */
      @media (forced-colors: active) {
        * {
          border-color: ButtonBorder;
        }
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        min-height: 100vh;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        font-family: system-ui, -apple-system, Arial, sans-serif;
        padding: 1rem;
        overflow-x: hidden;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        transition: background-color 0.3s ease, color 0.3s ease;
        line-height: 1.5;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        padding: 0.8rem;
        border-radius: 50%;
        border: 1px solid var(--border-color);
        background-color: var(--bg-secondary);
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 1000;
      }

      .disclaimer {
        width: 100%;
        max-width: 600px;
        margin: 1rem auto;
        padding: 1rem;
        text-align: center;
        line-height: 1.5;
        background-color: var(--bg-secondary);
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        font-size: 0.9rem;
        color: var(--text-primary);
      }

      p {
        text-align: center;
        margin: 1rem 0;
        width: 100%;
        font-size: 0.9rem;
        color: #e0e0e0;
      }

      #topicSelect {
        width: 90%;
        max-width: 300px;
        margin: 1rem auto;
        padding: 0.8rem;
        font-size: 1rem;
        color: var(--text-primary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background-color: var(--bg-secondary);
        background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007CB2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
        background-repeat: no-repeat;
        background-position: right 0.7rem top 50%;
        background-size: 0.65rem auto;
        padding-right: 2.5rem;
        -webkit-appearance: none;
        appearance: none;
        cursor: pointer;
      }

      #content {
        width: 100%;
        max-width: 800px;
        margin: 1rem auto;
        padding: 1rem;
        background-color: var(--bg-secondary);
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      #content pre {
        white-space: pre-wrap;
        word-wrap: break-word;
        font-size: 0.9rem;
        line-height: 1.6;
        padding: 1rem;
        background-color: var(--bg-code);
        border-radius: 6px;
        overflow-x: auto;
        color: var(--text-primary);
      }

      /* Prism specific dark mode styles */
      .token.comment,
      .token.prolog,
      .token.doctype,
      .token.cdata {
        color: #8e8e8e; /* Light gray for comments */
      }

      .token.punctuation {
        color: #f5f5f5;
      }

      .token.tag {
        color: #cc99ff;
      }

      .token.property,
      .token.constant {
        color: #f5a623;
      }

      .token.boolean {
        color: #ff5c8e;
      }

      .token.number {
        color: #f9c74f;
      }

      .token.selector {
        color: #7ec8a1;
      }

      .token.string {
        color: #f7a8b8;
      }

      .token.symbol {
        color: #e0e0e0;
      }

      .token.operator {
        color: #f5f5f5;
      }

      .token.atrule {
        color: #e0e0e0;
      }

      .token.keyword {
        color: #5e99cc;
      }

      .token.function {
        color: #7bd8c9;
      }

      .token.class-name {
        color: #f7b1e3;
      }

      .token.regex,
      .token.important {
        color: #ff7f8f;
      }

      .token.variable {
        color: #1e73e8;
      }

      @media (max-width: 600px) {
        body {
          padding: 0.5rem;
        }

        .disclaimer {
          font-size: 0.8rem;
          padding: 0.8rem;
        }

        #topicSelect {
          font-size: 0.9rem;
          padding: 0.6rem;
        }

        #content {
          padding: 0.8rem;
        }

        #content pre {
          font-size: 0.8rem;
          padding: 0.8rem;
        }
      }

      /* Add these styles to your existing <style> tag */
      .chat-container {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        z-index: 1000;
      }

      .chat-toggle {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        padding: 1rem;
        border-radius: 50%;
        border: none;
        background: var(--bg-secondary);
        color: var(--text-primary);
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .chat-widget {
        position: fixed;
        bottom: 5rem;
        right: 2rem;
        width: 300px;
        height: 400px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        display: none;
        flex-direction: column;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .chat-header {
        padding: 1rem;
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
      }

      .chat-input {
        padding: 1rem;
        border-top: 1px solid var(--border-color);
        display: flex;
        gap: 0.5rem;
      }

      .chat-input input {
        flex: 1;
        padding: 0.5rem;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        background: var(--bg-secondary);
        color: var(--text-primary);
      }

      .chat-input button {
        padding: 0.5rem 1rem;
        background: var(--bg-secondary);
        color: var(--text-primary);
        border: 1px solid var(--border-color);
        border-radius: 4px;
        cursor: pointer;
      }

      .spinner {
        width: 20px;
        height: 20px;
        border: 2px solid var(--border-color);
        border-top: 2px solid var(--text-primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        display: none;
        margin: 1rem auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <!-- <button class="theme-toggle" id="themeToggle">🌙</button> -->
    <div class="disclaimer">
      Disclaimer: For educational use only. The author does not take
      responsibility for any misuse of the content provided.
      <br />
      <br />ANSWERS ARE NOT VERIFIED <br />Access Keys Will be Added Soon
    </div>

    <p><b>By RANGANDALE</b></p>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    <!-- Add Axios before other scripts -->
    <script>
      // Theme toggle setup
      const setupThemeToggle = () => {
        try {
          const themeToggle = document.getElementById("themeToggle");
          if (!themeToggle) {
            console.error("Theme toggle button not found!");
            return;
          }

          const html = document.documentElement;
          const prefersDark = window.matchMedia(
            "(prefers-color-scheme: dark)"
          ).matches;

          // Set initial theme
          let currentTheme =
            localStorage.getItem("theme") || (prefersDark ? "dark" : "light");
          setTheme(currentTheme);

          // Make sure button is visible
          themeToggle.style.display = "block";
          themeToggle.style.opacity = "1";

          // Add click handler
          themeToggle.addEventListener("click", () => {
            currentTheme = html.getAttribute("data-theme");
            const newTheme = currentTheme === "light" ? "dark" : "light";
            setTheme(newTheme);
          });
        } catch (error) {
          console.error("Error setting up theme toggle:", error);
        }
      };

      const setTheme = (theme) => {
        const html = document.documentElement;
        html.setAttribute("data-theme", theme);
        localStorage.setItem("theme", theme);
        document.getElementById("themeToggle").textContent =
          theme === "light" ? "🌙" : "☀️";
      };

      // Chat functionality
      const DEBOUNCE_DELAY = 1000;
      let lastRequestTime = 0;

      const handleAsk = async () => {
        const questionInput = document.getElementById("question");
        const responseDiv = document.getElementById("response");
        const button = document.getElementById("askButton");
        const spinner = document.getElementById("spinner");
        const question = questionInput.value.trim();

        if (!question) {
          responseDiv.innerHTML =
            '<span class="error">Please enter a question</span>';
          return;
        }

        const now = Date.now();
        if (now - lastRequestTime < DEBOUNCE_DELAY) {
          responseDiv.innerHTML =
            '<span class="error">Please wait a moment</span>';
          return;
        }

        button.disabled = true;
        spinner.style.display = "inline-block";
        responseDiv.innerHTML = "Please wait...";

        try {
          const response = await axios.post(
            "https://rangandale.pythonanywhere.com/api/ask",
            { question },
            {
              headers: { "Content-Type": "application/json" },
            }
          );

          if (response.data?.choices?.[0]?.message?.content) {
            responseDiv.innerHTML = response.data.choices[0].message.content;
          } else {
            throw new Error("Invalid response format");
          }

          lastRequestTime = now;
          questionInput.value = "";
        } catch (error) {
          console.error("Error:", error);
          responseDiv.innerHTML = `<span class="error">${
            error.response?.data?.error || "Something went wrong"
          }</span>`;
        } finally {
          button.disabled = false;
          spinner.style.display = "none";
        }
      };

      // Initialize everything when DOM is loaded
      document.addEventListener("DOMContentLoaded", () => {
        setupThemeToggle();

        // Setup chat widget
        const chatToggle = document.getElementById("chatToggle");
        const chatWidget = document.getElementById("chatWidget");
        const closeBtn = document.querySelector(".close-btn");
        const askButton = document.getElementById("askButton");
        const questionInput = document.getElementById("question");

        chatToggle.addEventListener("click", () => {
          chatWidget.style.display =
            chatWidget.style.display === "none" ? "flex" : "none";
          chatToggle.style.transform =
            chatWidget.style.display === "none" ? "scale(1)" : "scale(0)";
        });

        closeBtn.addEventListener("click", () => {
          chatWidget.style.display = "none";
          chatToggle.style.transform = "scale(1)";
        });

        askButton.addEventListener("click", handleAsk);

        questionInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter" && !e.shiftKey) {
            e.preventDefault();
            handleAsk();
          }
        });
      });
    </script>
    <script src="scripts.js"></script>

    <!-- Add chat container before closing body tag -->
    <div class="chat-container">
      <button id="chatToggle" class="chat-toggle">💭</button>
      <div id="chatWidget" class="chat-widget">
        <div class="chat-header">
          <h3>Ai Assistant</h3>
          <button class="close-btn">×</button>
        </div>
        <div
          class="chat-messages"
          id="response"
          role="alert"
          aria-live="polite"
        ></div>
        <div class="chat-input">
          <input
            type="text"
            id="question"
            placeholder="Ask a question..."
            aria-label="Your question"
            maxlength="500"
          />
          <button id="askButton">Send</button>
        </div>
        <div class="spinner" id="spinner"></div>
      </div>
    </div>
  </body>
</html>
